---
import type { News } from "../types/microcms";

interface Props {
  news: News[];
}

const { news } = Astro.props;
const base = import.meta.env.BASE_URL.replace(/\/$/, "");

function formatDate(dateStr: string): string {
  const d = new Date(dateStr);
  const y = d.getFullYear();
  const m = String(d.getMonth() + 1).padStart(2, "0");
  const day = String(d.getDate()).padStart(2, "0");
  return `${y}.${m}.${day}`;
}
---

<section class="py-20 bg-white dark:bg-[#151515]" id="news">
  <div class="container mx-auto px-6 md:px-20">
    <div class="flex items-end gap-4 mb-12">
      <h2 class="font-serif text-3xl font-bold tracking-tight text-text-main dark:text-white">News</h2>
      <span class="text-sm text-primary font-medium mb-1 tracking-wider uppercase opacity-80">最新情報</span>
    </div>
    <div class="flex flex-col">
      {news.map((item) => {
        const href = item.url || `${base}/news/${item.id}`;
        return (
          <a href={href} class="news-item group flex flex-col md:flex-row md:items-center gap-2 md:gap-8 py-6 hover:bg-gray-50 dark:hover:bg-gray-800/30 transition-colors px-4 -mx-4 rounded">
            <time class="text-sm font-mono text-text-muted whitespace-nowrap">{formatDate(item.published_at)}</time>
            <span class="text-xs font-bold text-primary bg-primary/10 px-2 py-1 rounded whitespace-nowrap self-start">{item.category}</span>
            <p class="text-sm md:text-base text-text-main dark:text-gray-200 group-hover:text-primary transition-colors">{item.title}</p>
            <span class="material-symbols-outlined text-text-muted text-sm ml-auto hidden md:block group-hover:translate-x-1 transition-transform">arrow_forward</span>
          </a>
        );
      })}
    </div>
  </div>
</section>
